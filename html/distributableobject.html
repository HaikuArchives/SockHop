<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Jeremy Friesner">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; I) [Netscape]">
   <TITLE>SHDistributableObject API</TITLE>
</HEAD>
<BODY>
<B><U>The SHDistributableObject inheritance API</U></B>
(derives from BArchivable)

<P>The SHDistributable class represents a SockHop-compatible object that
is part of a known add-on file, and can thus be automatically distributed
to nodes on the SockHop tree.&nbsp; Its API is as follows:

<P>
<HR WIDTH="100%">
<BR><B>virtual status_t GetAddOnSpec(<A HREF="shfilespecs.html">SHFileSpec</A>
&amp; addToSpec) const</B> = 0

<P>This method is how SockHop finds out where the add-on file(s) that implement
this object are.&nbsp; The user/installer of the SockHop program is responsible
for making sure that the appropriate files are in the proper places on
disk (usually relative to the root executable's current directory) at program
startup.&nbsp; Note that the add-ons need <I>only</I> be put onto the disk
of the root computer--SockHop will automatically propagate them to the
other computers as needed.

<P>If your object requires other files (such as shared libraries or data
files) in order to be instantiated properly, it is okay to add those to
the SHFileSpec as well.&nbsp; All specified files (for the appropriate
architecture) will be downloaded before the SHDistributableObject is instantiated.

<P>SHDistributableObject subclasses will should implement this method to
add to (addToSpec) references to the appropriate add-on file or shared
library that contains the class implementation for this object's class.&nbsp;
All subclasses should also pass the GetAddOnSpec() call on to their parent
class's GetAddOnSpec() implementation.

<P>(An implementation note:&nbsp; This method is called when Archiving
the SHDistributableObject, not when unarchiving it!&nbsp; So you have to
specify your add-on files at the sending node, not at the receiving one)
<BR>&nbsp;
<BR>
<HR WIDTH="100%">
<BR><B>status_t Archive(BMessage * archive, bool deep = true) const</B>

<P>This method should be called by the Archive() method of all SHDistributableObject
subclasses.&nbsp; It adds information about this SHDistributableObject
into (archive).&nbsp; In particular, it calls GetAddOnSpec(), and adds
the resulting <A HREF="shfilespecs.html">SHFileSpec</A> to (archive) as
a Flattened object.&nbsp; It may occasionally be necessary to manually
retrieve this Flattened object from the archive BMessage--it can be found
under the field name SH_NAME_ADDONSPEC.&nbsp;&nbsp; (Note:&nbsp; SH_NAME_ADDONSPEC
is a #define in sockhop/SockHopConstants.h, not the literal text string!&nbsp;
You should use the #define to avoid grief due to typos, upgrades, etc)

<P>
<HR WIDTH="100%">
<BR><B>int32 GetId() const</B>

<P>This method returns an ID number for the SHDistributableObject.&nbsp;
This number is mainly for SockHop's internal use.&nbsp; It is only guaranteed
to be unique across the node that the SHDistributableObject is living on,
and is NOT propogated with the object as the object moves from node to
node--that is, the ID number will change when the object moves to another
node.&nbsp; Use this method at your own risk...
<BR>&nbsp;
</BODY>
</HTML>
