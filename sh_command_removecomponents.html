<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Jeremy Friesner">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; I) [Netscape]">
   <TITLE>Example of SH_COMMAND_REMOVECOMPONENTS</TITLE>
</HEAD>
<BODY>
<B>Basic Examples of SH_COMMAND_REMOVECOMPONENTS</B>
<BR>&nbsp;
<BR>
<HR WIDTH="100%">
<BR>Example 1:&nbsp;&nbsp;&nbsp; Remove all children from node "/Joe" whose
names begin with the letter "X".

<P><TT>&nbsp;&nbsp;&nbsp; BMessage msg(SH_COMMAND_REMOVECOMPONENTS);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_TO, "/Joe");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_CHILDREN, "X*");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; root->PostMessage(&amp;msg);</TT>

<P>Note:&nbsp; <A HREF="sh_command_quit_example.html">Another way to do
this</A> is to send an SH_COMMAND_QUIT BMessage to the child nodes themselves:

<P>
<HR WIDTH="100%">
<BR>Example 2:&nbsp;&nbsp;&nbsp; Remove all symlinks that originate from
node "/Joe".

<P><TT>&nbsp;&nbsp;&nbsp; BMessage msg(SH_COMMAND_REMOVECOMPONENTS);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_TO, "/Joe");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_SYMLINKS, "*");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; root->PostMessage(&amp;msg);</TT>

<P>Note:&nbsp; The SH_NAME_SYMLINKS field will cause only children that
are symlinks to be removed.&nbsp; It will never affect "real" children.&nbsp;
However, the SH_NAME_CHILDREN field <I>will</I> cause symlinks to be removed,
if the symlinks' names match the specified regular expression string(s).

<P>
<HR WIDTH="100%">
<BR>Example 3:&nbsp;&nbsp;&nbsp; Remove files "file1" and "file2" from
"/Joe"'s disk, using SH_NAME_FILES.

<P><TT>&nbsp;&nbsp;&nbsp; BMessage msg(SH_COMMAND_REMOVECOMPONENTS);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_TO, "/Joe");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; SHNodeSpec filesToDelete;</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; filesToDelete.AddFlavor(SHFlavor("file1", 0,
0, 0, false));&nbsp; // specify all args manually so that AddFlavor() will</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; filesToDelete.AddFlavor(SHFlavor("file2", 0,
0, 0, false));&nbsp; // succeed even if the files don't exist on the sending
node.</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddFlat(SH_NAME_FILES, &amp;multiFiles);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; root->PostMessage(&amp;msg);</TT>
<BR>&nbsp;
<HR WIDTH="100%">
<BR>Example 4:&nbsp;&nbsp;&nbsp; Remove SHWorkers whose names start with
the phrase "RemoveMe", and the SHSorter named "DeadFred", from node "/Joe".

<P><TT>&nbsp;&nbsp;&nbsp; BMessage msg(SH_COMMAND_REMOVECOMPONENTS);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_TO, "/Joe");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_WORKERS, "RemoveMe*");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_SORTERS, "DeadFred");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; root->PostMessage(&amp;msg);</TT>

<P>
<HR WIDTH="100%">

<P><B>Fancy Examples of SH_COMMAND_REMOVECOMPONENTS</B>
<BR>&nbsp;
<BR>
<HR WIDTH="100%">
<BR>Example 5:&nbsp;&nbsp;&nbsp; Remove all children, symlinks, and workers,
and sorters from "/Joe":

<P><TT>&nbsp;&nbsp;&nbsp; BMessage msg(SH_COMMAND_REMOVECOMPONENTS);</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_TO, "/Joe");</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_WORKERS, "*");&nbsp; //
Removes all SHWorkers</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_SORTERS, "*");&nbsp; //
Removes all SHSorters (except the default SHWi1dPathSorter)</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; msg.AddString(SH_NAME_CHILDREN, "*"); // This
will remove all symlinks also!</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; root->PostMessage(&amp;msg);</TT>

<P>(Actually, this won't remove the SHWi1dPathSorter that the node was
given on startup--that sorter is protected from removal, because the SockHop
server uses it for internal operations)
<BR>&nbsp;
<BR>&nbsp;
</BODY>
</HTML>
